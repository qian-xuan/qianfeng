<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title>主页</title>
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <script type="text/javascript">
        (async () => {
            const res = await fetch("/type/getTypes")
            const types = (await res.json())

            const html = (await Promise.all(types.map(async t => {
                const contains = await fetch(`/commodity/containsType?id=${t.id}`)

                let disabled = "disabled=\"disabled\""
                if (await contains.json())
                    disabled = ""

                return (
                `<tr class="card-sub">
                    <td>${t.id}</td>
                    <td style="width: 50px;text-align: center;">${t.name}</td>
                    <td style="text-align: center;width: 200px;">
                        <button style="" class="btn btn-warning" onclick="upd(${t.id})">修改</button>
                        <button style="" ${disabled} class="btn btn-danger" onclick="del(${t.id})">删除</button>
                    </td>
                </div></tr>`)
            }))).join("")
            document.querySelector("table").innerHTML += html
        })()

        function add(){
            location.href="/type/add"
        }
        function del(id){
            location.href="/type/del?id="+id
        }
        function upd(id){
            location.href="/type/update?id="+id
        }
    </script>
    <style>
        body {
            width: 100%;
            height: 100%;
            /*background: url("") no-repeat;*/
            background-size: cover;
        }
        .th{
            height: 50px;
        }
        .card{
            background: rgba(255, 255, 255, 0.1);
            margin: auto;
            overflow: hidden;
            background: #F5F5F5;
            box-shadow: 5px 5px 15px rgba(186, 126, 126, 0.6);
            border-radius: 10px;
        }
        /*.card {*/
        /*    !* 添加阴影来创建"卡片"效果 *!*/
        /*    box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);*/
        /*    transition: 0.3s;*/
        /*    border-radius: 5px; !* 5px圆角 *!*/
        /*    width: 100%;*/
        /*    display: flex;*/
        /*}*/

        /* 鼠标悬停时，添加更深的阴影 */
        .card:hover {
            box-shadow: 10px 10px 20px rgba(186, 126, 126, 0.6);
        }

        .card-body {
            padding: 20px;
            border-radius: 20px;
            background: #ffffff;
        }

        /* 让表格中的文字在必要时换行 */
        .card-table {
            word-break: break-all;
            width: 100%;
        }

        .card-body tr {
            border-bottom: 1px solid black;
            margin-top: 4px;
            margin-bottom: 4px;
            border-radius: 20px;
        }

        .card-sub{
            background: #ffffff;
        }
    </style>
</head>
<body>

<div class="container-form" layout:fragment="content">
    <button type="button"
            onclick="add()"
            class="btn btn-primary" style="text-align: center;">
        新增</button>
    <div class="card" id="app">
        <div class="card-body">
            <table class="card-table">
                <thead>
                <tr style="color: #BA7E7E;text-align: center;background: #f5f7f8;">
                    <th class="th">
                        类别id
                    </th>
                    <th class="th">
                        类别名称
                    </th>
                    <th class="th">
                        操作
                    </th>
                </tr>
                </thead>
            </table>
        </div>
    </div>
</div>
<script src="https://unpkg.com/vue@2/dist/vue.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script>

</script>
</body>
</html>